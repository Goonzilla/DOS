utils = {
	
}

local utils_mt = class( utils )

function utils:init( config )
	local gaddr = component.get( tostring( config:get( "gpuMain" ), "gpu" ) ) 
	local saddr = component.get( tostring( config:get( "screenMain" ) ), "screen" )
	component.setPrimary( "gpu", gaddr )
	component.setPrimary( "screen", saddr )

	local gpu = component.proxy( gaddr )
	gpu.bind( saddr )

	local w, h = gpu.maxResolution( )
	gpu.setResolution( w, h )
	utils:setTextDefaults( gpu )
	utils:clear( gpu )

	return gpu
end

function utils:debugInit( config )
	local gaddr = component.get( tostring( config:get( "gpuDebug" ), "gpu" ) )
	local saddr = component.get( tostring( config:get( "screenDebug" ) ), "screen" )

	local gpu = component.proxy( gaddr )
	gpu.bind( saddr )

	local w, h = gpu.maxResolution( )
	gpu.setResolution( w, h )
	gpu.setBackground( colors.black )
	gpu.setForeground( colors.white )
	utils:clear( gpu )

	return gpu
end

function utils:scaleRes( gpu, scale )
	local w, h = gpu.maxResolution( )
	gpu.setResolution( w / scale, h / scale )
end

function utils:clock( gpu )
	local w, h = gpu.getResolution( )
	gpu.set( w-24, 1, "Minecraft Time: " .. os.time( ) )
end

function utils:setTextDefaults( gpu )
	gpu.setBackground( 0x000000 )
	gpu.setForeground( 0xFF1000 )
end

function utils:scroll( gpu, lines )
	local w, h = gpu.getResolution( )
	gpu.copy( 1, 1 + lines, w, h - lines, 0, -lines )
	gpu.fill( 1, h - lines + 1, w, lines, " " )
end

function utils:writeConsole( gpu, str )
	local w, h = gpu.getResolution( )
	gpu.set( 1, h, str )
	utils:scroll( gpu, 1 )
end

function utils:clear( gpu )
	local w, h = gpu.getResolution( )
	gpu.fill( 1, 1, w, h, " " )
end

function utils:checkFile( str )
	return( fs.exists( fs.concat( shell.getWorkingDirectory( ), str ) ) )
end